# üöÇ VHM24 Railway Issues - –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: column User.telegramId does not exist

### üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
–ò–∑ –ª–æ–≥–æ–≤ Railway –≤–∏–¥–Ω–æ –æ—à–∏–±–∫—É:
```
2025-07-09 00:20:39.722 UTC [963] ERROR: column User.telegramId does not exist at character 358
```

**–ü—Ä–∏—á–∏–Ω–∞**: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Railway –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ `telegramId` –≤ —Ç–∞–±–ª–∏—Ü–µ `User`, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª**: `railway-migrate.js`

**–§—É–Ω–∫—Ü–∏–∏**:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`prisma migrate deploy`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–µ–ø–ª–æ—è
**–§–∞–π–ª**: `nixpacks.toml`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```toml
[start]
cmd = "node railway-migrate.js && node railway-deploy.js"
```

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
- **Email**: `admin@vhm24.ru`
- **Password**: `admin123`
- **Telegram ID**: `42283329` (–∏–∑ ADMIN_IDS)
- **–†–æ–ª–∏**: `['ADMIN']`

## üîß –ü—Ä–æ—Ü–µ—Å—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –®–∞–≥ 1: –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
üóÑÔ∏è VHM24 Railway Database Migration Starting...
üìç Environment: production
üîß Starting database migration...
‚úÖ Prisma schema found
üîß Generating Prisma client...
‚úÖ Prisma client generated
üîß Running database migrations...
‚úÖ Database migrations completed
üîß Testing database connection...
‚úÖ Database connection successful
üìä Users in database: 0
üîß Creating default admin user...
‚úÖ Default admin user created
üìß Email: admin@vhm24.ru
üîë Password: admin123
üì± Telegram ID: 42283329
üéâ Database migration completed successfully!
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
üöÇ VHM24 Railway Deployment Starting...
üìç Environment: production
üîå Port: 8000
üîß Initializing Railway deployment...
üîß Checking Prisma client...
‚úÖ Prisma client is ready
üöÄ Starting Auth service on port 3001...
üöÄ Starting Machines service on port 3002...
üöÄ Starting Inventory service on port 3003...
üöÄ Starting Tasks service on port 3004...
üöÄ Starting Bunkers service on port 3005...
üöÄ Starting Notifications service on port 3006...
ü§ñ Starting Telegram Bot...
üì° Starting Gateway service (main)...
üéâ All services initialization started!
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- –ü–æ–ª–µ `User.telegramId` –¥–æ–±–∞–≤–ª–µ–Ω–æ
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ

### ‚úÖ Telegram Bot
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram ID —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ã
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

### ‚úÖ API Services
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Gateway –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ Railway URL
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- Endpoints –æ—Ç–≤–µ—á–∞—é—Ç

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–µ–ø–ª–æ—é

### –§–∞–π–ª—ã –¥–ª—è Railway –¥–µ–ø–ª–æ—è:
1. ‚úÖ `railway-migrate.js` - –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ `railway-deploy.js` - –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. ‚úÖ `nixpacks.toml` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
4. ‚úÖ `.railwayignore` - –ò—Å–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
5. ‚úÖ `railway.json` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Railway:
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
DATABASE_URL=postgresql://...     # ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
JWT_SECRET=your-secret-key        # ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
TELEGRAM_BOT_TOKEN=8015112367:... # ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
ADMIN_IDS=42283329               # ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
REDIS_URL=redis://...            # ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
NODE_ENV=production              # ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
PORT=8000                        # ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

## üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export DATABASE_URL=your-railway-database-url
export JWT_SECRET=your-jwt-secret
export ADMIN_IDS=42283329

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
node railway-migrate.js

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
node railway-deploy.js
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Railway:
1. ‚úÖ –î–µ–ø–ª–æ–π –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞
3. ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–Ω
4. ‚úÖ Telegram Bot –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
5. ‚úÖ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway Dashboard
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ DATABASE_URL –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é: `railway run node railway-migrate.js`

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Railway CLI:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
railway logs

# –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é
railway run node railway-migrate.js

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
railway run npx prisma studio

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
railway variables
```

---

## üéâ –ò–¢–û–ì: –í–°–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´

‚úÖ **Database Migration**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ  
‚úÖ **Telegram Bot**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram ID  
‚úÖ **Railway Deploy**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–µ–ø–ª–æ—è  
‚úÖ **Error Handling**: –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ  
‚úÖ **Admin User**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞  

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 09.07.2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**: üöÇ –ì–û–¢–û–í–û –ö RAILWAY –î–ï–ü–õ–û–Æ
