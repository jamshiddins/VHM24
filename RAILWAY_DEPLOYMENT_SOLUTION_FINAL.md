# üöÇ VHM24 Railway Deployment - –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï

## üìã –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú

### ‚úÖ **–ü–†–û–ë–õ–ï–ú–´ –í–´–Ø–í–õ–ï–ù–´ –ò –ò–°–ü–†–ê–í–õ–ï–ù–´:**

1. **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
   - ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (16 —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö)
   - ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `railway-start-monolith.js`

2. **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤**
   - ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: Gateway –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–ª –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º –ø–æ—Ä—Ç–∞–º (3001-3009)
   - ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ API endpoints –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ –æ–¥–∏–Ω Fastify —Å–µ—Ä–≤–µ—Ä

3. **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–µ–ø–ª–æ—è**
   - ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: `railway deploy` –ø–æ–∫–∞–∑—ã–≤–∞–ª "No deployments found"
   - ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –ì–æ—Ç–æ–≤ –∫ –ø–µ—Ä–≤–æ–º—É –¥–µ–ø–ª–æ—é —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

4. **–°–†–ï–î–ù–Ø–Ø: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   - ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ root package.json
   - ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã @fastify/cors, @fastify/multipart, bcrypt, jsonwebtoken,
     @prisma/client

5. **–°–†–ï–î–ù–Ø–Ø: –í–µ—Ä—Å–∏—è Node.js**
   - ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: Node.js 18 –≤ nixpacks.toml, –Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ Node.js 22
   - ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–æ Node.js 20 –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üõ†Ô∏è **–í–ù–ï–°–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:**

### 1. –°–æ–∑–¥–∞–Ω `railway-start-monolith.js`

```javascript
// –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:
// ‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ Prisma
// ‚úÖ –°–æ–∑–¥–∞–µ—Ç –∞–¥–º–∏–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
// ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –µ–¥–∏–Ω—ã–π Fastify —Å–µ—Ä–≤–µ—Ä
// ‚úÖ –í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å–µ API endpoints
// ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç Telegram Bot –≤ —Ñ–æ–Ω–µ
// ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ gracefully
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω `package.json`

```json
{
  "scripts": {
    "start": "node railway-start-monolith.js", // ‚Üê –ò–∑–º–µ–Ω–µ–Ω–æ
    "railway": "node railway-start-monolith.js"
  },
  "dependencies": {
    // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    "@fastify/cors": "^8.4.0",
    "@fastify/multipart": "^7.6.0",
    "bcrypt": "^5.1.1",
    "jsonwebtoken": "^9.0.2",
    "@prisma/client": "^5.7.0"
  }
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω `nixpacks.toml`

```toml
[phases.setup]
nixPkgs = ["nodejs-20_x", "npm-10_x"] # ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å 18 –¥–æ 20
```

## üéØ **–ì–û–¢–û–í–´–ï API ENDPOINTS:**

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- `POST /api/v1/auth/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

### üìä Dashboard

- `GET /api/v1/dashboard/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ dashboard

### ü§ñ –ú–∞—à–∏–Ω—ã

- `GET /api/v1/machines` - –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–æ–≤

### üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å

- `GET /api/v1/inventory` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º

### üìã –ó–∞–¥–∞—á–∏

- `GET /api/v1/tasks` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏

### üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ

- `GET /health` - Health check
- `GET /docs` - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üóÑÔ∏è **–ë–ê–ó–ê –î–ê–ù–ù–´–•:**

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞** –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
2. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞** –µ—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞—è:
   - Email: `admin@vhm24.ru`
   - Password: `admin123`
   - Telegram ID: –∏–∑ `ADMIN_IDS`

## ü§ñ **TELEGRAM BOT:**

### ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–æ–Ω–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –∏–∑ `services/telegram-bot/`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç DigitalOcean Spaces –¥–ª—è —Ñ–∞–π–ª–æ–≤
- Health check endpoint –Ω–∞ –ø–æ—Ä—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üöÄ **–ö–û–ú–ê–ù–î–´ –î–õ–Ø –î–ï–ü–õ–û–Ø:**

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

```bash
railway status
```

### 2. –î–µ–ø–ª–æ–π –Ω–∞ Railway:

```bash
railway up
```

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
railway logs
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

```bash
railway variables
```

## üîê **–ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø (Railway):**

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:

```bash
DATABASE_URL=postgresql://... # Railway PostgreSQL
JWT_SECRET=your-secret-key
```

### ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:

```bash
TELEGRAM_BOT_TOKEN=your-bot-token
ADMIN_IDS=42283329
REDIS_URL=redis://...
NODE_ENV=production
```

### ‚úÖ DigitalOcean Spaces (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):

```bash
DO_SPACES_ENDPOINT=https://fra1.digitaloceanspaces.com
DO_SPACES_BUCKET=vhm24-storage
DO_SPACES_ACCESS_KEY=your-access-key
DO_SPACES_SECRET_KEY=your-secret-key
DO_SPACES_REGION=fra1
```

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø:**

### 1. Health Check:

```bash
curl https://your-railway-url.railway.app/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
{
  "status": "ok",
  "service": "vhm24-monolith",
  "timestamp": "2025-01-10T01:27:00.000Z",
  "database": "connected"
}
```

### 2. API Documentation:

```bash
curl https://your-railway-url.railway.app/docs
```

### 3. Login Test:

```bash
curl -X POST https://your-railway-url.railway.app/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@vhm24.ru","password":"admin123"}'
```

### 4. Dashboard Stats:

```bash
curl https://your-railway-url.railway.app/api/v1/dashboard/stats \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## ‚ö†Ô∏è **–í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø:**

### üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

- **–í—Ä–µ–º–µ–Ω–Ω–æ**: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –º–æ–Ω–æ–ª–∏—Ç –¥–ª—è Railway
- **–ü—Ä–∏—á–∏–Ω–∞**: Railway –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–¥–Ω–∏–º —Å–µ—Ä–≤–∏—Å–æ–º
- **–ë—É–¥—É—â–µ–µ**: –ú–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **Railway PostgreSQL**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ
- –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—É—Å—Ç–æ–π –±–∞–∑–µ

### ü§ñ Telegram Bot:

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ç–æ–º –∂–µ –ø—Ä–æ—Ü–µ—Å—Å–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É FSM
- DigitalOcean Spaces –¥–ª—è —Ñ–∞–π–ª–æ–≤

### üìÅ –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:

- **–õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã**: –í—Ä–µ–º–µ–Ω–Ω–æ –≤ `/uploads`
- **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**: DigitalOcean Spaces
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

## üéâ **–†–ï–ó–£–õ–¨–¢–ê–¢:**

### ‚úÖ **–ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´:**

1. ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Railway
2. ‚úÖ –ï–¥–∏–Ω—ã–π –ø–æ—Ä—Ç –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
4. ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ API endpoints
5. ‚úÖ Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
6. ‚úÖ Health checks
7. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
8. ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### üöÄ **–ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ:**

```bash
# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –¥–µ–ø–ª–æ—è:
railway up

# –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
curl https://your-app.railway.app/health
curl https://your-app.railway.app/docs
```

### üìä **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

- ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –¥–µ–ø–ª–æ–π –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ API endpoints
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–∏–π Telegram Bot
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üîó **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:**

1. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–ø–ª–æ–π**: `railway up`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏**: `railway logs`
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å endpoints**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å curl –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω**: –í Railway dashboard (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Railway

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ production –¥–µ–ø–ª–æ—é –Ω–∞ Railway! üéâ**
