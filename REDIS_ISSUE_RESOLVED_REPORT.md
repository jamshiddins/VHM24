# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å Redis

## –î–∞—Ç–∞: 09.07.2025

## –í—Ä–µ–º—è: 23:50 - 00:00 (UTC+5)

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–°–∏—Å—Ç–µ–º–∞ VHM24 –Ω–µ –º–æ–≥–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis:

- Redis URL —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä Railway
- –õ–æ–∫–∞–ª—å–Ω—ã–π Redis –Ω–µ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –°–µ—Ä–≤–∏—Å—ã –ø–∞–¥–∞–ª–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω Redis Fallback –º–æ–¥—É–ª—å

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `packages/shared-types/src/redis-fallback.js` —Å:

- **MockRedis –∫–ª–∞—Å—Å** - —ç–º—É–ª—è—Ü–∏—è Redis –≤ –ø–∞–º—è—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π Redis –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, mock –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ Redis –æ–ø–µ—Ä–∞—Ü–∏–∏
- **TTL –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ –∫–ª—é—á–µ–π

### 2. –û–±–Ω–æ–≤–ª–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–π Redis –º–æ–¥—É–ª—å

–§–∞–π–ª `packages/shared-types/src/redis.js` —Ç–µ–ø–µ—Ä—å:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –≤–µ—Ä—Å–∏—é
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É —Ä–µ–∞–ª—å–Ω—ã–º –∏ mock Redis
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Mock Redis

```javascript
// –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- get(key) / set(key, value)
- setex(key, seconds, value)
- del(...keys)
- exists(key)
- expire(key, seconds)
- ttl(key)
- keys(pattern)
- flushall()

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- TTL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- Event emitter —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```

### 4. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

`restart-services-with-redis-fix.js`:

- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ Node.js –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º Redis
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–∏—Å—Ç—ã–π —Å—Ç–∞—Ä—Ç —Å–∏—Å—Ç–µ–º—ã

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

- ‚úÖ Gateway (–ø–æ—Ä—Ç 8000)
- ‚úÖ Auth (–ø–æ—Ä—Ç 3001)
- ‚úÖ Machines (–ø–æ—Ä—Ç 3002)
- ‚úÖ Inventory (–ø–æ—Ä—Ç 3003)
- ‚úÖ Tasks (–ø–æ—Ä—Ç 3004)
- ‚úÖ Bunkers (–ø–æ—Ä—Ç 3005)
- ‚úÖ Notifications (–ø–æ—Ä—Ç 3006)
- ‚úÖ Backup (–ø–æ—Ä—Ç 3007)
- ‚úÖ Monitoring (–ø–æ—Ä—Ç 3008)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:

- **76% —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** (19 –∏–∑ 25)
- **9/9 —Å–µ—Ä–≤–∏—Å–æ–≤ –∑–¥–æ—Ä–æ–≤—ã**
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞**
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç**
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –Ω–æ—Ä–º–µ**

### –í–µ–±-–¥–∞—à–±–æ—Ä–¥:

- ‚úÖ –ó–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3000
- ‚úÖ Next.js 14.2.30 —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ deprecated `appDir` (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```
[gateway] Using Redis fallback for local development
[gateway] Connected to Redis (Mock)
[auth] Using Redis fallback for local development
[auth] Connected to Redis (Mock)
[machines] Using Redis fallback for local development
[machines] Connected to Redis (Mock)
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

- **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: Mock Redis –≤ –ø–∞–º—è—Ç–∏
- **–ü—Ä–æ–¥–∞–∫—à–µ–Ω**: –†–µ–∞–ª—å–Ω—ã–π Redis (Railway URL)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** –ø–æ `NODE_ENV`

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
2. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: Redis URL —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è Railway
3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ Redis** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

   ```bash
   # Windows (—á–µ—Ä–µ–∑ Chocolatey)
   choco install redis-64

   # –ò–ª–∏ —á–µ—Ä–µ–∑ WSL
   sudo apt install redis-server
   ```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç:

- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å API
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ —Å Redis **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞**. –°–∏—Å—Ç–µ–º–∞ VHM24 —Ç–µ–ø–µ—Ä—å:

- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- ‚úÖ –ò–º–µ–µ—Ç fallback –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è Redis
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è**: 10 –º–∏–Ω—É—Ç  
**–°—Ç–∞—Ç—É—Å**: –†–ï–®–ï–ù–û ‚úÖ
