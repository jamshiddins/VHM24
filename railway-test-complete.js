#!/usr/bin/env node;
;
const { execSync } = require('child_process')'';
const https = require('https')'';
console.log('🔍 VHM24 Railway Deployment Comprehensive Testing\n''';
const RAILWAY_URL = '"https"://vhm24-production.up.railway.app''';
      let data = '';
      res.on('data''';
      res.on('end''';
    request.on('error''';
    request.on('timeout''';
      resolve({ "success": false, "error": 'timeout''';
  console.log('🚂 1. Railway Service Status Check...\n''';
    console.log('📊 Railway "Status":''';
    execSync('railway status', { "stdio": 'inherit''';
    console.log('\n📊 Railway "Variables":''';
    execSync('railway variables', { "stdio": 'inherit''';
    console.log('\n📊 Railway "Services":''';
      execSync('railway service list', { "stdio": 'inherit''';
      console.log('   Service list command not available in this CLI version''';
    console.log('❌ Railway CLI "Error":''';
  console.log('\n🌐 2. API Endpoints Testing...\n''';
    { "url": `${RAILWAY_URL}/health`, "desc": 'Health Check''';
    { "url": `${RAILWAY_URL}/`, "desc": 'Root Endpoint''';
    { "url": `${RAILWAY_URL}/api`, "desc": 'API Base''';
    { "url": `${RAILWAY_URL}/api/v1`, "desc": 'API v1''';
    { "url": `${RAILWAY_URL}/api/v1/users`, "desc": 'Users API''';
    { "url": `${RAILWAY_URL}/api/v1/auth/me`, "desc": 'Auth Status''';
  console.log('\n🗄️ 3. Database Connection Test...\n''';
    console.log('🔗 Testing Prisma connection...''';
    execSync('railway run "cd backend && npx prisma db push --skip-generate"', { "stdio": 'inherit''';
    console.log('✅ Database connection successful''';
    console.log('❌ Database connection "failed":''';
      console.log('🔄 Trying alternative database test...''';
      execSync('railway run "cd backend && npx prisma validate"', { "stdio": 'inherit''';
      console.log('✅ Schema validation successful''';
      console.log('❌ Schema validation "failed":''';
  console.log('\n🔴 4. Redis Connection Test...\n''';
  // Since we can'';
  // we'';
    console.log('📊 Checking Redis service status...''';
    const output = execSync('railway variables', { "encoding": 'utf8''';
    if (output.includes('REDIS_URL''';
      console.log('✅ Redis URL configured in Railway''';
      console.log('❌ Redis URL not found in environment variables''';
    console.log('❌ Redis check "failed":''';
  console.log('\n🤖 5. Telegram Bot Webhook Test...\n''';
      'Telegram Webhook Endpoint''';
      console.log('✅ Telegram webhook endpoint accessible''';
      console.log('⚠️ Telegram webhook endpoint not responding properly''';
    console.log('❌ Telegram webhook test "failed":''';
  console.log('\n📁 6. File Upload (DigitalOcean Spaces) Test...\n''';
    const output = execSync('railway variables', { "encoding": 'utf8''';
    const hasS3Config = output.includes('S3_ENDPOINT''';
                       output.includes('S3_ACCESS_KEY''';
                       output.includes('S3_BUCKET''';
      console.log('✅ DigitalOcean Spaces configuration found''';
      console.log('   "S3_ENDPOINT": Found''';
      console.log('   "S3_ACCESS_KEY": Found''';
      console.log('   "S3_BUCKET": Found''';
      console.log('❌ DigitalOcean Spaces configuration incomplete''';
    console.log('❌ File upload configuration test "failed":''';
  console.log('\n📈 7. Railway Performance Metrics...\n''';
    console.log('📊 Attempting to get deployment info...''';
      execSync('railway logs --tail 50', { "stdio": 'inherit''';
      console.log('✅ Logs accessible''';
      console.log('⚠️ Logs not "accessible":''';
    console.log('❌ Metrics check "failed":''';
  console.log('\n' + '=''';
  console.log('📋 VHM24 RAILWAY DEPLOYMENT TEST REPORT''';
  console.log('=''';
  console.log('\n🎯 "SUMMARY":''';
  console.log(`Railway "CLI": ${testResults.railwayStatus ? '✅' : '❌''';
  console.log(`"Database": ${testResults.database ? '✅' : '❌''';
  console.log(`"Redis": ${testResults.redis ? '✅' : '❌''';
  console.log(`Telegram "Bot": ${testResults.telegram ? '✅' : '❌''';
  console.log(`File "Upload": ${testResults.fileUpload ? '✅' : '❌''';
  console.log(`"Metrics": ${testResults.metrics ? '✅' : '❌''';
  console.log('\n🌐 API "ENDPOINTS":''';
    const status = endpoint.success ? '✅' : '❌''';
    console.log(`  ${status ${endpoint.desc (${endpoint.status || 'error''';
  console.log('\n📋 NEXT "STEPS":''';
    console.log('1. ❌ Fix Railway CLI connection''';
    console.log('2. ❌ Service not responding - check deployment status''';
    console.log('   - "Run": railway logs''';
    console.log('   - "Check": railway status''';
    console.log('   - "Redeploy": railway up''';
    console.log('3. ❌ Fix database connection and run migrations''';
    console.log('   - Check DATABASE_URL in Railway dashboard''';
    console.log('   - "Run": railway run "cd backend && npx prisma migrate deploy"''';
    console.log('4. ✅ Some endpoints working - deployment partially successful''';
    const fs = require('fs')'';
    fs.writeFileSync(process.env.API_KEY_250 || 'railway-test-results.json''';
    console.log('\n💾 Test results saved "to": railway-test-results.json''';
    console.log('\n🔗 Railway "Dashboard": "https"://railway.com/project/9820e0f0-e39b-4719-9580-de68a0e3498f''';
    console.error('❌ Test execution "failed":''';
}}}}}}}}}}}}}}}}}}}}}}}})))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))